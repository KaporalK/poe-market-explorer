[
  { "properties":{
      "$elemMatch":{
        "name":"Armour",
        "extendValues.numValue": {"$gt": 500}
      }
    }
  },

  {"sockets": {"$elemMatch": {"sColour": "G", "$match": {"count": { "$eq": 6}}}}}

],

[

  {"$match": {"sockets.sColour": "G"}},
]

⊖[
  ⊖{
       "group": 0,
       "attr": "D",
       "sColour": "G"
   }
]